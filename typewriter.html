<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Experience the Typewriter Â· Typewriter Tales</title>
  "/>
  <style>
    .tw-page {
      max-width: 780px;
      margin: 0 auto;
      padding: 56px 24px 100px;
    }
    .tw-header {
      text-align: center;
      margin-bottom: 36px;
    }
    .tw-header h1 {
      font-family: 'Special Elite', serif;
      font-size: 2rem;
      margin-bottom: 10px;
    }
    .tw-header p {
      font-size: 0.82rem;
      color: #999;
      letter-spacing: 0.04em;
    }
    .name-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 20px;
    }
    .name-bar label {
      font-size: 0.78rem;
      color: #aaa;
      letter-spacing: 0.06em;
    }
    .name-bar input {
      font-family: 'Courier Prime', monospace;
      font-size: 0.85rem;
      padding: 7px 14px;
      border: 1px solid #d4cdc0;
      background: #fdfaf3;
      color: #2c2c2c;
      width: 220px;
      outline: none;
      letter-spacing: 0.04em;
    }
    .name-bar input:focus { border-color: #aaa; }
    .ribbon-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 24px;
      font-size: 0.75rem;
      color: #aaa;
      letter-spacing: 0.08em;
    }
    .color-dot {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border-color 0.2s, transform 0.15s;
    }
    .color-dot:hover { transform: scale(1.25); }
    .color-dot.active { border-color: #555; }
    .paper {
      background: #fdfaf3;
      border: 1px solid #e0d9ce;
      box-shadow: 3px 3px 0 #e0d9ce;
      padding: 48px 56px 48px 80px;
      min-height: 400px;
      position: relative;
      cursor: text;
      background-image: linear-gradient(
        #fdfaf3 0px, #fdfaf3 27px,
        #e0d9ce 27px, #e0d9ce 28px
      );
      background-size: 100% 28px;
    }
    .paper::before {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      left: 56px;
      width: 1px;
      background: #f0b0a8;
      opacity: 0.7;
    }
    #typed-display {
      font-family: 'Courier Prime', monospace;
      font-size: 1rem;
      line-height: 28px;
      white-space: pre-wrap;
      word-break: break-word;
      color: #2c2c2c;
      min-height: 28px;
      position: relative;
      z-index: 1;
    }
    .tw-cursor-live {
      display: inline-block;
      width: 9px;
      height: 1em;
      background: currentColor;
      vertical-align: text-bottom;
      margin-left: 1px;
      animation: blink 0.75s step-end infinite;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50%       { opacity: 0; }
    }
    @keyframes clack {
      0%   { transform: translateX(0); }
      30%  { transform: translateX(-1px); }
      70%  { transform: translateX(1px); }
      100% { transform: translateX(0); }
    }
    .clack { animation: clack 0.07s ease; }
    .paper-hint {
      text-align: center;
      margin-top: 12px;
      font-size: 0.72rem;
      color: #ccc;
      letter-spacing: 0.06em;
    }
    .char-count {
      text-align: center;
      margin-top: 8px;
      font-size: 0.72rem;
      color: #ccc;
    }
    .action-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      margin-top: 28px;
      flex-wrap: wrap;
    }
    .wall-link {
      text-align: center;
      margin-top: 20px;
      font-size: 0.78rem;
    }
    .wall-link a {
      color: #888;
      text-decoration: none;
      border-bottom: 1px solid #ddd;
      transition: color 0.2s;
    }
    .wall-link a:hover { color: #2c2c2c; }
    .toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: #2c2c2c;
      color: #fdfaf3;
      font-family: 'Courier Prime', monospace;
      font-size: 0.82rem;
      padding: 12px 28px;
      letter-spacing: 0.06em;
      opacity: 0;
      transition: opacity 0.3s, transform 0.3s;
      pointer-events: none;
      z-index: 300;
    }
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    .sound-btn {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: #f0ebe0;
      border: 1px solid #d4cdc0;
      border-radius: 50%;
      width: 42px;
      height: 42px;
      cursor: pointer;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      z-index: 200;
      transition: background 0.2s;
    }
    .sound-btn:hover { background: #e5e0d5; }
    #ghost {
      position: fixed;
      opacity: 0;
      pointer-events: none;
      top: -9999px;
      left: -9999px;
    }
    @media (max-width: 600px) {
      .paper { padding: 36px 20px 36px 48px; }
      .paper::before { left: 32px; }
    }
  </style>
</head>
<body>

<nav>
  <a href="index.html" class="nav-logo">Typewriter Tales</a>
  <ul class="nav-links">
    ><a href="index.html">home</a></li>
    ><a href="blogs.html">blogs</a></li>
    ><a href="typewriter.html" class="active">experience</a></li>
  </ul>
</nav>

<div class="page-wrapper">
  <div class="tw-page">

    <div class="tw-header">
      <h1>Experience the Typewriter</h1>
      <p>write something. anything. it will be saved and shared on the wall.</p>
    </div>

    <div class="name-bar">
      abel for="author-name">signed as â†’</label>
      <input type="text" id="author-name" placeholder="your name or stay anonymous" maxlength="40"/>
    </div>

    <div class="ribbon-bar">
      <span>ribbon â†’</span>
      <div class="color-dot active" data-color="#2c2c2c" style="background:#2c2c2c"></div>
      <div class="color-dot" data-color="#b22222" style="background:#b22222"></div>
      <div class="color-dot" data-color="#1a3a6b" style="background:#1a3a6b"></div>
      <div class="color-dot" data-color="#2d6a4f" style="background:#2d6a4f"></div>
      <div class="color-dot" data-color="#6b3fa0" style="background:#6b3fa0"></div>
    </div>

    <div class="paper" id="paper">
      <div id="typed-display">
        <span class="tw-cursor-live" id="tw-cursor"></span>
      </div>
    </div>

    <p class="paper-hint">click the paper Â· start typing Â· enter for new line</p>
    <p class="char-count"><span id="char-count">0</span> / 1000 characters</p>

    <div class="action-bar">
      <button class="btn" id="clear-btn">clear</button>
      <button class="btn" id="copy-btn">copy text</button>
      <button class="btn btn-fill" id="submit-btn">publish to wall â†’</button>
    </div>

    <div class="wall-link">
      <a href="wall.html">see what others have written â†’</a>
    </div>

  </div>
</div>

<footer>
  &copy; 2026 Â· Typewriter Tales Â· made with patience and coffee
</footer>

<div class="toast" id="toast"></div>
<button class="sound-btn" id="sound-btn">ðŸ”‡</button>
<textarea id="ghost" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp }
    from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBPnZ8f4cek3JcIwfopsmxnCAGTXoH--yc",
    authDomain: "typewritertales-5bdda.firebaseapp.com",
    projectId: "typewritertales-5bdda",
    storageBucket: "typewritertales-5bdda.firebasestorage.app",
    messagingSenderId: "631041179526",
    appId: "1:631041179526:web:7d2fea0e3a5b48ce567607"
  };

  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  let text     = '';
  let inkColor = '#2c2c2c';
  let soundOn  = false;
  const MAX    = 1000;

  const display   = document.getElementById('typed-display');
  const cursor    = document.getElementById('tw-cursor');
  const ghost     = document.getElementById('ghost');
  const paper     = document.getElementById('paper');
  const charCount = document.getElementById('char-count');
  const soundBtn  = document.getElementById('sound-btn');
  const clearBtn  = document.getElementById('clear-btn');
  const copyBtn   = document.getElementById('copy-btn');
  const submitBtn = document.getElementById('submit-btn');
  const toast     = document.getElementById('toast');
  const authorEl  = document.getElementById('author-name');

  function showToast(msg, duration = 3000) {
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), duration);
  }

  function render() {
    while (display.firstChild !== cursor) {
      display.removeChild(display.firstChild);
    }
    if (text.length > 0) {
      cursor.insertAdjacentText('beforebegin', text);
    }
    display.style.color     = inkColor;
    cursor.style.background = inkColor;
    charCount.textContent   = text.length;
  }

  function shake() {
    display.classList.remove('clack');
    void display.offsetWidth;
    display.classList.add('clack');
  }

  let audioCtx = null;
  function getAudio() {
    if (!audioCtx) {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    return audioCtx;
  }

  function playClack() {
    if (!soundOn) return;
    try {
      const ctx = getAudio();
      const buf = ctx.createBuffer(1, ctx.sampleRate * 0.04, ctx.sampleRate);
      const d   = buf.getChannelData(0);
      for (let i = 0; i < d.length; i++) {
        d[i] = (Math.random() * 2 - 1) * Math.exp(-i / (ctx.sampleRate * 0.008));
      }
      const src  = ctx.createBufferSource();
      src.buffer = buf;
      const g    = ctx.createGain();
      g.gain.value = 0.18;
      src.connect(g);
      g.connect(ctx.destination);
      src.start();
    } catch(e) {}
  }

  paper.addEventListener('click', () => ghost.focus());

  window.addEventListener('load', () => {
    ghost.focus();
    render();
  });

  ghost.addEventListener('blur', () => {
    setTimeout(() => ghost.focus(), 50);
  });

  ghost.addEventListener('keydown', e => {
    if (e.key === 'Backspace') {
      e.preventDefault();
      if (text.length > 0) {
        text = text.slice(0, -1);
        playClack();
        shake();
        render();
      }
      return;
    }
    if (e.key === 'Enter') {
      e.preventDefault();
      if (text.length < MAX) {
        text += '\n';
        shake();
        render();
      }
      return;
    }
    if (e.key.length === 1 && text.length < MAX) {
      text += e.key;
      playClack();
      shake();
      render();
    }
  });

  document.querySelectorAll('.color-dot').forEach(dot => {
    dot.addEventListener('click', e => {
      e.stopPropagation();
      document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
      dot.classList.add
